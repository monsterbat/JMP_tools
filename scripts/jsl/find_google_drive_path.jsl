// Google Drive è·¯å¾‘æª¢æ¸¬å·¥å…·
// ç”¨é€”ï¼šå¹«åŠ©ç”¨æˆ¶æ‰¾åˆ°ä»–å€‘çš„ Google Drive è·¯å¾‘å’Œå¸³æˆ¶è³‡è¨Š

Names Default To Here(1);

Write("=== Google Drive è·¯å¾‘æª¢æ¸¬å·¥å…· ===");
Write("");

// å–å¾—ç”¨æˆ¶å
userName = Get Environment Variable("USER");
Write("ç›®å‰ç”¨æˆ¶ï¼š" || userName);

// CloudStorage åŸºç¤è·¯å¾‘
cloudStoragePath = "/Users/" || userName || "/Library/CloudStorage/";
Write("CloudStorage åŸºç¤è·¯å¾‘ï¼š" || cloudStoragePath);

// æª¢æŸ¥ CloudStorage è³‡æ–™å¤¾æ˜¯å¦å­˜åœ¨
If(Directory Exists(cloudStoragePath),
    Write("âœ… CloudStorage è³‡æ–™å¤¾å­˜åœ¨");
    Write("");
    
    // åˆ—å‡ºæ‰€æœ‰ CloudStorage ä¸­çš„é …ç›®
    allItems = Files In Directory(cloudStoragePath);
    Write("CloudStorage ä¸­çš„æ‰€æœ‰é …ç›®ï¼š");
    For(i = 1, i <= N Items(allItems), i++,
        item = allItems[i];
        itemPath = cloudStoragePath || item;
        If(Directory Exists(itemPath),
            Write("ğŸ“ " || item);
        ,
            Write("ğŸ“„ " || item);
        );
    );
    
    Write("");
    
    // å°ˆé–€æœå°‹ Google Drive ç›¸é—œè³‡æ–™å¤¾
    Write("æœå°‹ Google Drive ç›¸é—œè³‡æ–™å¤¾ï¼š");
    googleDriveFolders = {};
    For(i = 1, i <= N Items(allItems), i++,
        item = allItems[i];
        If(Contains(item, "GoogleDrive-") & Directory Exists(cloudStoragePath || item),
            Insert Into(googleDriveFolders, item);
            Write("ğŸŸ¢ æ‰¾åˆ°ï¼š" || item);
        );
    );
    
    // åˆ†ææ‰¾åˆ°çš„ Google Drive è³‡æ–™å¤¾
    If(N Items(googleDriveFolders) > 0,
        Write("");
        Write("=== Google Drive å¸³æˆ¶åˆ†æ ===");
        For(i = 1, i <= N Items(googleDriveFolders), i++,
            folder = googleDriveFolders[i];
            // æå–å¸³æˆ¶åç¨± (ç§»é™¤ GoogleDrive- å‰ç¶´)
            account = Substr(folder, 13); // "GoogleDrive-" æœ‰ 12 å€‹å­—ç¬¦
            Write("å¸³æˆ¶ " || Char(i) || "ï¼š" || account);
            
            // æª¢æŸ¥å¸¸è¦‹çš„ Google Drive å…§éƒ¨çµæ§‹
            fullPath = cloudStoragePath || folder;
            Write("   å®Œæ•´è·¯å¾‘ï¼š" || fullPath);
            
            // æª¢æŸ¥æ˜¯å¦æœ‰ã€Œæˆ‘çš„é›²ç«¯ç¡¬ç¢Ÿã€è³‡æ–™å¤¾
            myDrivePath = fullPath || "/æˆ‘çš„é›²ç«¯ç¡¬ç¢Ÿ";
            If(Directory Exists(myDrivePath),
                Write("   âœ… æ‰¾åˆ°ã€Œæˆ‘çš„é›²ç«¯ç¡¬ç¢Ÿã€è³‡æ–™å¤¾");
                
                // æª¢æŸ¥ç›®æ¨™è·¯å¾‘æ˜¯å¦å­˜åœ¨
                targetPath = myDrivePath || "/100_Work/meta";
                If(Directory Exists(targetPath),
                    Write("   âœ… æ‰¾åˆ°ç›®æ¨™è·¯å¾‘ï¼š100_Work/meta");
                    
                    // æª¢æŸ¥ test_data.csv æ˜¯å¦å­˜åœ¨
                    testFilePath = targetPath || "/test_data.csv";
                    If(File Exists(testFilePath),
                        Write("   âœ… æ‰¾åˆ°ç›®æ¨™æª”æ¡ˆï¼štest_data.csv");
                        Write("   ğŸ¯ å®Œæ•´æª”æ¡ˆè·¯å¾‘ï¼š" || testFilePath);
                    ,
                        Write("   âŒ æ‰¾ä¸åˆ° test_data.csv");
                        Write("   ğŸ’¡ å»ºè­°ï¼šè«‹å°‡æª”æ¡ˆæ”¾åœ¨ " || targetPath);
                    );
                ,
                    Write("   âŒ æ‰¾ä¸åˆ° 100_Work/meta è·¯å¾‘");
                    Write("   ğŸ’¡ å»ºè­°ï¼šè«‹æª¢æŸ¥ Google Drive ä¸­æ˜¯å¦æœ‰æ­¤è³‡æ–™å¤¾çµæ§‹");
                );
            ,
                Write("   âŒ æ‰¾ä¸åˆ°ã€Œæˆ‘çš„é›²ç«¯ç¡¬ç¢Ÿã€è³‡æ–™å¤¾");
                // åˆ—å‡ºå¯¦éš›å­˜åœ¨çš„å­è³‡æ–™å¤¾
                subItems = Files In Directory(fullPath);
                Write("   ğŸ“‹ å¯¦éš›çš„å­è³‡æ–™å¤¾ï¼š");
                For(j = 1, j <= N Items(subItems), j++,
                    subItem = subItems[j];
                    If(Directory Exists(fullPath || "/" || subItem),
                        Write("      ğŸ“ " || subItem);
                    );
                );
            );
            Write("");
        );
    ,
        Write("âŒ æ²’æœ‰æ‰¾åˆ°ä»»ä½• Google Drive è³‡æ–™å¤¾");
        Write("ğŸ’¡ å¯èƒ½çš„åŸå› ï¼š");
        Write("   1. Google Drive å°šæœªå®‰è£");
        Write("   2. Google Drive å°šæœªåŒæ­¥");
        Write("   3. ä½¿ç”¨ä¸åŒçš„é›²ç«¯åŒæ­¥æ–¹å¼");
    );
,
    Write("âŒ CloudStorage è³‡æ–™å¤¾ä¸å­˜åœ¨");
    Write("ğŸ’¡ å¯èƒ½çš„åŸå› ï¼š");
    Write("   1. é€™ä¸æ˜¯ macOS ç³»çµ±");
    Write("   2. Google Drive ä½¿ç”¨èˆŠç‰ˆæœ¬çš„åŒæ­¥æ–¹å¼");
    Write("   3. ä½¿ç”¨ç¬¬ä¸‰æ–¹é›²ç«¯åŒæ­¥è»Ÿé«”");
);

Write("");
Write("=== æª¢æ¸¬å®Œæˆ ===");
Write("å¦‚æœéœ€è¦æ‰‹å‹•æŸ¥æ‰¾ï¼Œè«‹ï¼š");
Write("1. æ‰“é–‹ Finder");
Write("2. æŒ‰ Command+Shift+G");
Write("3. è¼¸å…¥ï¼š~/Library/CloudStorage/");
Write("4. æŸ¥çœ‹æ˜¯å¦æœ‰ GoogleDrive- é–‹é ­çš„è³‡æ–™å¤¾"); 